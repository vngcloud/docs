# Container lifecycle

Lifecycle is a feature developed by VNG Cloud that allows you to set up actions that vStorage applies to a container. We define two types of rules to help you manage the lifecycle of the container:

1. Transition rule: This rule supports the movement of objects between storage classes. For example, you can set up a lifecycle rule to move an object from the Gold storage class to the Silver storage class if the object has not been accessed within 30 days.
2. Expiration rule: This rule supports the deletion of objects based on specific conditions. For instance, you can set up a rule to delete objects belonging to the Gold storage class after a certain period from the date the object exists in the vStorage system.

![](https://www.vngcloud.vn/documents/20126/1455799/vng-cloud-product-vstorage-lifecycle-vi-02-slideshow.jpg)

| The processing of objects in a single lifecycle rule run depends on the **number of objects** in the container that your lifecycle rule is set up for and the **workload** of our system. If the container has **many objects** or the system is under high load, the processing will be **slow and may continue for the next few days.** If the container has **few objects** or the system is under low load, the processing will be **fast and may be completed in one day**. To ensure that object processing is efficient and fast, you should split up lifecycle rule runs and use filters to minimize the number of objects that need to be processed. |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

To create a lifecycle container, you can follow the instructions below on the vStorage Portal:

| <p><br></p> |
| ----------- |

1. Log in to [https://vstorage.console.vngcloud.vn](https://vstorage.console.vngcloud.vn).
2. Select the **project** and choose the **container** for which you want to set up the lifecycle.
3. Click ![](http://docs.vngcloud.vn/download/thumbnails/67994132/image2023-3-6\_10-35-20.png?version=1\&modificationDate=1700794658000\&api=v2)on the container icon or select ![](http://docs.vngcloud.vn/download/thumbnails/67994132/image2023-2-6\_10-20-54.png?version=1\&modificationDate=1700794658000\&api=v2) it to use the container lifecycle feature and click ![](http://docs.vngcloud.vn/download/thumbnails/67994132/image2023-11-27\_8-54-59.png?version=1\&modificationDate=1701050101000\&api=v2)
4. The **Lifecycle screen** appears. Choose **Create a lifecycle rule**.
5. Enter the Lifecycle **Rule Name**. The allowed characters for the Lifecycle Rule Name include letters (a-z, A-Z), numbers (0-9), '\_', and '-'. The length of your Lifecycle **Rule Name** must be between 5 and 50.
6. Select the **Rule Type** and enter a **Rule Description** if necessary. We provide you with two types of rules:
   1. Transition: Rule to support moving objects between storage classes.
   2. Expiration: Rule to support deleting objects based on specified conditions.
7. Enter the **Filter**. This filter applies to a specific lifecycle rule. Each lifecycle rule can have only one filter, and we provide you with filtering options, including:
   1. If you want to search for objects based on Prefix:
      1. Select **Prefix**.
      2. Enter the prefix string you want to search for.
   2. If you want to search for objects based on Wildcard:
      1. Select **Wildcard**.
      2. Enter the wildcard string you want to search for.
   3. If you want to search for objects based on Regex:
      1. Select **Regex**.
      2. Enter the regex string you want to search for.

For example, if you want to search for objects with a common prefix in the object name as **file,** you need to set up the filter as follows:

* Select **Prefix**
* Enter the prefix **file**

You can learn more about how we search results using each method in the table below:

| **Number**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | **Search by**                                                                                                                                                                                                                                              | **Example syntax**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Search result                                                                                                                                                                                                                                                                                                                                                                     | Description                                                                                                                                                                                                                                                                                                                                                                                                        |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Name match by prefix                                                                                                                                                                                                                                       | <p>Name match by prefix <strong>abc</strong> (object in the container)</p><p>Name match by prefix <strong>directoryA/abc</strong> (object in directoryA)</p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | **abc1, abc2**,…distinguish between lower case and lower case.                                                                                                                                                                                                                                                                                                                    | Search by comparing the entered string with the prefix of the object's name.                                                                                                                                                                                                                                                                                                                                       |
| 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | <p>Name match by wildcard</p><p><strong>(Comming soon)</strong></p>                                                                                                                                                                                        | <p>Name match by wildcard <strong>ab*c</strong> (object in the container)</p><p>Name match by wildcard <strong>?abc?</strong> (object in the container)</p><p>Name match by wildcard <strong>abc*.?xt</strong> (object in the container)</p><p>Name match by wildcard <strong>ab\*c.txt</strong> (object in the container)</p><p>Name match by wildcard <strong>directoryA/ab*c</strong> (object in the directoryA)</p><p>Name match by wildcard <strong>directoryA/?abc?</strong> (object in the directoryA)</p><p>Name match by wildcard <strong>directoryA/abc*.?xt</strong> (object in the directoryA)</p><p>Name match by wildcard <strong>directoryA/ab\*c.txt</strong> (object in the directoryA)</p> | <p><strong>abc, abdc, ab)c, abUUc, ab&#x26;-Bc</strong>…distinguish between lower case and lower case.</p><p><strong>1abcx, -abc*, 1abcD,…</strong> distinguish between lower case and lower case.</p><p><strong>abc.txt, abc123.^xt,</strong>… distinguish between lower case and lower case.</p><p><strong>ab*c.txt</strong> distinguish between lower case and lower case.</p> | <p><strong>*</strong>: 0 tới n ký tự bất kỳ, ký tự này có thể là chữ cái in hoa, in thường, ký tự số hoặc ký tự đặc biệt.</p><p><strong>?</strong>: 1 ký tự bất kỳ, ký tự này có thể là chữ cái in hoa, in thường, ký tự số hoặc ký tự đặc biệt.</p><p><strong>\</strong>*, <strong>\</strong>?: ký tự *, ? lúc này được coi là một ký tự trong bình thường, không phải là toán tử đại diện sử dụng để search.</p> |
| 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | <p>Name match by regex</p><p><strong>(Comming soon)</strong></p><p><br></p>                                                                                                                                                                                | <p>Name match by regex <strong>ab.</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/ab.</strong> (object in the directoryA)</p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | **ab1,ab2,ab3, abx, ab\*,**… distinguish between lower case and lower case.                                                                                                                                                                                                                                                                                                       | **.**: Matches any character                                                                                                                                                                                                                                                                                                                                                                                       |
| <p>Name match by regex <strong>abc?</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/abc?</strong> (object in the directoryA)</p>                                                                                                                                                                                                                                                                                                                                                | **ab, abc** distinguish between lower case and lower case.                                                                                                                                                                                                 | **?**: Repeat the preceding character zero or one times. Often used to make the preceding character optional.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <p>Name match by regex <strong>ab+</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/ab+</strong> (object in the directoryA)</p>                                                                                                                                                                                                                                                                                                                                                  | **ab, abb, abbb**,… distinguish between lower case and lower case.                                                                                                                                                                                         | **+**: Repeat the preceding character one or more times.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <p>Name match by regex <strong>ab*</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/ab*</strong> (object in the directoryA)</p>                                                                                                                                                                                                                                                                                                                                                  | **a, ab, abb, abbb**,… distinguish between lower case and lower case.                                                                                                                                                                                      | **\***: Repeat the preceding character zero or more times.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <p>Name match by regex <strong>a{2}</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/a{2}</strong> (object in the directoryA)</p><p>Name match by regex <strong>a{2,4}</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/a{2,4}</strong> (object in the directoryA)</p><p>Name match by regex <strong>a{2,}</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/a{2,}</strong> (object in the directoryA)</p>          | <p><strong>aa</strong> distinguish between lower case and lower case.</p><p><strong>aa, aaa, aaaa</strong> distinguish between lower case and lower case.</p><p><strong>aa, aaa, aaaa, aaaaa,</strong>… distinguish between lower case and lower case.</p> | {}: Minimum and maximum number of times the preceding character can repeat.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <p>Name match by regex <strong>abc|xyz</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/abc|xyz</strong> (object in the directoryA)</p>                                                                                                                                                                                                                                                                                                                                          | **abc, xyz** distinguish between lower case and lower case.                                                                                                                                                                                                | \|: OR operator. The match will succeed if the longest pattern on either the left side OR the right side matches.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <p>Name match by regex</p><p>Name match by regex <strong>abc(xyz)</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/abc(xyz)</strong> (object in the directoryA)</p>                                                                                                                                                                                                                                                                                                              | **abc, abcxyz** distinguish between lower case and lower case.                                                                                                                                                                                             | (): Forms a group. You can use a group to treat part of the expression as a single character.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <p>Name match by regex <strong>[abc]</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/ [abc]</strong> (object in the directoryA)</p><p>Name match by regex <strong>[a-d]</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/ [a-d]</strong> (object in the directoryA)</p><p>Name match by regex <strong>[^abc\-]</strong> (object in the container)</p><p>Name match by regex <strong>directoryA/ [^abc\-]</strong> (object in the directoryA)</p> | <p><strong>a, b, c</strong> distinguish between lower case and lower case.</p><p><strong>a, b, c, d</strong> distinguish between lower case and lower case.</p><p><strong>khác a, b, c, hoặc -</strong> distinguish between lower case and lower case.</p> | <p>[ ]: Match one of the characters in the brackets.</p><p>A <code>^</code> before a character in the brackets negates the character or range</p><p>\: OR</p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <p>Name match by regex <strong>a{2,6}+d?*</strong></p><p>Name match by regex <strong>directoryA/ a{2,6}+d?*</strong></p><p>Name match by regex <strong>directoryA{2,6}+d?*/ a{2,6}+d?*/ a{2,6}+d?*</strong></p>                                                                                                                                                                                                                                                                                                 | **aaaaaaa, aaaaaaaaaaaaddddd,**… distinguish between lower case and lower case.                                                                                                                                                                            | Use nested operators within a regex search syntax.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                    |

\


| <p><strong>Note:</strong></p><ol><li>You can create a lifecycle rule of one of the two types (transition, expiration) on any container in any project. This means that if you have set up a transition rule for container01, you cannot set up an expiration rule for container01, and vice versa.</li><li>If you set up a transition rule for a container, you can create a maximum of 1 transition rule.</li><li>If you set up an expiration rule for a container, you can create a maximum of 10 expiration rules.</li></ol> |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

When you choose:

| <p><strong>The transition rule will move objects that meet certain conditions from the Gold storage class to the Silver storage class. Currently, the transition feature is only supported for:</strong></p><ul><li><strong>Moving objects for postpaid customer accounts.</strong></li><li><strong>Moving objects from the Gold container to the Silver container.</strong></li></ul><p>8. Choose the destination and time when objects are moved</p><ul><li><strong>Transition to</strong>: select vStorage Silver.</li><li>Then enter the <strong>number of days</strong> since the last time the object was accessed (Get/Download request).</li></ul><p>After you successfully create a new transition-type Lifecycle rule, the vStorage system will automatically create a container with the tier suffix with the Silver storage class. For example, when you create a transition-type lifecycle rule for Container01 (Gold storage class), the system will automatically create Container01_tier (Silver storage class). Within 2 hours from the creation of the lifecycle rule, the vStorage system will execute the rule, and objects that meet the conditions will be moved from Container01 to Container01_tier without changing the object URL.</p> |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

***

| <p><strong>Expiration rule will delete objects in the container based on certain conditions. Currently, the expiration feature supports:</strong></p><ul><li><strong>Deleting objects for both pre-paid and post-paid customer accounts.</strong></li><li><strong>Deleting objects in Gold, Silver, and Archive containers. (For Archive containers, the minimum number of days to perform object deletion is 180 days).</strong></li></ul><p>8. Select the action that occurs with objects in the chosen container, including:</p><ul><li><strong>Expire current versions of objects</strong>: Use when you want to set up the deletion of objects in the original container based on a period of time from the date the object exists in the vStorage system. This rule applies to deleting objects in non-versioning containers. When you choose this setting, you need to enter the number of days from the object's initialization.</li></ul><p><img src="http://docs.vngcloud.vn/download/attachments/67994132/image2023-11-27_9-27-25.png?version=1&#x26;modificationDate=1701052048000&#x26;api=v2" alt=""><br></p><ul><li><strong>Permanently delete previous versions:</strong> Use when you want to set up the deletion of objects in the corresponding version container of the original container based on a period of time from when the versioned object was created. This rule applies to deleting objects in versioned containers. When you choose this setting, you need to enter the number of days from when the object becomes an old version (meaning the object exists in the versioned container).</li></ul><p><img src="http://docs.vngcloud.vn/download/attachments/67994132/image2023-11-27_9-28-16.png?version=1&#x26;modificationDate=1701052099000&#x26;api=v2" alt=""><br></p><ul><li><strong>Expire marked-deleted objects:</strong> Use when you want to set up the deletion of files marked as deleted generated in versioned containers. (Delete marked files are files generated when you delete an object in the original container that has versioning enabled). This rule applies to deleting objects in versioned containers.</li></ul><p><img src="http://docs.vngcloud.vn/download/attachments/67994132/image2023-11-27_9-29-31.png?version=1&#x26;modificationDate=1701052173000&#x26;api=v2" alt="" data-size="original"></p><p>Sau khi bạn thực hiện tạo mới Lifecycle rule loại expiration thành công, trong vòng 2h kể từ khi lifecycle rule được tạo, hệ thống vStorage sẽ thực hiện chạy rule, các object thỏa mãn điều kiện sẽ được xóa.</p><p>Tham khảo 2 ví dụ bên dưới để hiểu cơ chế hoạt động của expiration rule: </p><p>Ví dụ 1: bạn đã tạo container01 (container01 chưa được bạn bật tính năng container versioning). Lúc này bạn có nhu cầu thiết lập 1 rule theo quy tắc: nếu 60 ngày mà các object không được truy cập thì hệ thống thực hiện xóa. Lúc này bạn sẽ thiết lập quy tắc expiration như sau: </p><p><br></p><p>After you have successfully created a new expiration-type Lifecycle rule, within 2 hours from the time the Lifecycle rule is created, the vStorage system will execute the rule, and objects that meet the conditions will be deleted.</p><p>Refer to the two examples below to understand the mechanism of expiration rule operation:</p><p>Example 1: You have created container01 (container01 has not been enabled with versioning). Now, you have a need to set up a rule according to the condition: if objects are not accessed for 60 days, the system will perform deletion. In this case, you will set up the expiration rule as follows:</p><p><img src="http://docs.vngcloud.vn/download/attachments/67994132/image2023-11-27_9-30-37.png?version=1&#x26;modificationDate=1701052239000&#x26;api=v2" alt="" data-size="original"></p><p>Within 2 hours from the time this Lifecycle rule is created, the vStorage system will execute the rule, examine the objects in container01, and delete objects that meet the condition of not being accessed for 60 days.</p><p>Example 2: You have created container01 (container01 has been enabled with versioning). Now, you have a need to set up a rule according to the condition: if objects are not accessed for 60 days, the system will perform deletion. In this case, you will set up the expiration rule as follows:</p><p><img src="http://docs.vngcloud.vn/download/attachments/67994132/image2023-11-27_9-31-29.png?version=1&#x26;modificationDate=1701052291000&#x26;api=v2" alt="" data-size="original"></p><p>Within 2 hours from the time this Lifecycle rule is created, the vStorage system will execute the rule, examine the objects in container01, container01_version, and perform the following actions:</p><ul><li>Delete objects in container01 that meet the condition of not being accessed for 60 days.</li><li>Delete objects in container01_version that meet the condition of being 60 days old (i.e., objects have existed in container01_version for 60 days).</li><li>Delete delete marker files generated in container01_version.</li></ul> |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

\


\


\


\
